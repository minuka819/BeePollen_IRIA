---
title: "First_Script"
author: "Minuka Hewapathirana"
date: "August 15, 2023"
output: pdf_document
---
```{r, global_options, eval=TRUE, echo=FALSE, cache=TRUE}
library(knitr)
opts_chunk$set(tidy.opts=list(width.cutoff=80), tidy = TRUE, fig.align='center',
               cache=FALSE, collapse=TRUE, echo=FALSE, eval=FALSE, include=FALSE,
               message=FALSE, quietly=TRUE, results='hide', warn.conflicts=FALSE, 
               warning=FALSE)
```
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Project Name Setting:
```{r}
analysis <- "BeePollen"
```

Quick load
```{r}
analysis <- "BeePollen"

library("rprojroot")

root <- rprojroot::is_rstudio_project

imagePath <- root$make_fix_file(".")(paste("r_environments", analysis, sep = "/"))

imageA <- dir(root$find_file(imagePath, path = root$find_file()))

load(paste(imagePath,imageA,sep = "/")) 

```

Source our custom R scripts:    
For this we will use the rprojroot package to set the directory structures. This will help us when finding our files to source functions. We specify ours is an RStudio project. The root object contains a function that will help us locate our package R files regardless of our current working directory.
```{r sourcing_my_functions, echo=FALSE, eval=TRUE, include=FALSE, cache=TRUE}
library("rprojroot")
library("Biostrings")
root <- rprojroot::is_rstudio_project

scriptsPath <- root$make_fix_file(".")("R")
scripts  <- dir(root$find_file("R", path = root$find_file()))
scriptsList <- paste(scriptsPath, scripts, sep = "//")
lapply(scriptsList, source)

#not using python scripts yet 
scriptsPyPath <- root$make_fix_file(".")("pythonScripts")
dir.create(scriptsPyPath, showWarnings = TRUE, recursive = TRUE)
scriptsPy <- dir(root$find_file(scriptsPyPath, path = root$find_file()))
scriptsPyList <- paste(scriptsPyPath, scriptsPy, sep = "//")

imagePath <- root$make_fix_file(".")(paste("r_environments", analysis, sep = "/"))
dir.create(imagePath, showWarnings = TRUE, recursive = TRUE)
imageA <- dir(root$find_file(imagePath, path = root$find_file())) # if there is already a data file in this directory if not running this for the first time

imagesList<- list(paste(imagePath,imageA,sep="/"))
#save the image
save.image(paste(imagePath, imageA, sep = "/"))
#imageLocation <
load(paste(imagePath,imageA,sep = "/")) # you need to be specific if you have more than one image saved in this directory
```

Record the path to the environment images directory:
```{r importChptImage, echo=TRUE, eval=TRUE, include=FALSE, cache=TRUE}
library("rprojroot")
sharedPath <- root$make_fix_file(".")("PIRL_working_directory")
dir.create(sharedPath, showWarnings = TRUE, recursive = TRUE)
sharedPathDirs <- dir(root$find_file(sharedPath, path = root$find_file()))
sharedPathAn <- paste(sharedPath, analysis, sep = "/")
dir.create(sharedPathAn, showWarnings = TRUE, recursive = TRUE)

#my own path to my metadata table

myPirlWD <- "isilon/CFIA-ACIA_projects/girouxeml/hewapathiranam/PIRL_working_directory/BeePollenAnalysis"
```

Importing premade metdata
```{r importChptImage, echo=TRUE, eval=TRUE, include=FALSE, cache=TRUE}
library("data.table")
library("readr")


metadataLocation <- paste(sharedPath,"metadataTables","Metadata_BCC_BCF_ITS1F_20222_05_16_Run.csv", sep="/")
FirstTable <- read_csv(metadataLocation)
```


